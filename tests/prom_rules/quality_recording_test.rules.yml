groups:
- name: quality-recordings-test
  interval: 1m
  rules:
  - record: ndcg_ma5m
    expr: avg_over_time(duri_ndcg_at_k{k="3",scope="all",domain="ALL"}[5m])
  - record: ndcg_std5m
    expr: stddev_over_time(duri_ndcg_at_k{k="3",scope="all",domain="ALL"}[5m])
  - record: ndcg_z5m
    expr: (duri_ndcg_at_k{k="3",scope="all",domain="ALL"} - ndcg_ma5m) / clamp_min(ndcg_std5m, 1e-6)
  - record: ndcg_wom5m_pct
    expr: clamp_min(
      (duri_ndcg_at_k{k="3",scope="all",domain="ALL"} - duri_ndcg_at_k{k="3",scope="all",domain="ALL"} offset 3m)
      / (duri_ndcg_at_k{k="3",scope="all",domain="ALL"} offset 3m), -1e9)
  - record: ndcg_err5m
    expr: (0.90 - ndcg_ma5m)


