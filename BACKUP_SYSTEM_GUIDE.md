# 🗂️ DuRi 백업 시스템 완전 가이드

> **⚠️ 중요**: 이 문서는 백업 명령 시 반드시 참조해야 하는 핵심 문서입니다!
> 백업 작업 전에 반드시 이 가이드를 확인하고 따라주세요.

---

## 🎯 백업 시스템 개요

### **DuRi의 3단계 백업 시스템**
DuRi는 단순한 파일 백업이 아닌, **완벽한 시스템 복제**까지 가능한 3단계 백업 시스템을 운영합니다.

#### **백업 요청 시 중요도 차이**
- **"백업"** → 일반 백업 (기본 수준, 핵심 파일만)
- **"백업백업"** → 중요 백업 (중간 수준, 중요 파일 + 추가 파일)
- **"백업백업백업"** → 완벽한 복제 수준 (최고 수준, 모든 파일 + 복제 가이드)

---

## 📁 백업 저장 위치

### **✅ 올바른 백업 저장 위치**
```
/mnt/c/Users/admin/Desktop/두리백업/
├── 2025-08/                    # 월별 폴더 (자동 생성)
│   ├── DuRi_일반백업_2025-08-08_v버전_설명.tar.gz
│   ├── DuRi_중요백업_2025-08-08_v버전_설명.tar.gz
│   └── DuRi_완전복제_2025-08-08_v버전_설명.tar.gz
└── backup-log.txt              # 백업 로그
```

### **❌ 잘못된 백업 저장 위치**
```
/home/duri/DuRiWorkspace/       # duri_head 내부 (잘못됨!)
├── DuRi_Backup_*.tar.gz
├── DuRi_BackupBackup_*.tar.gz
└── DuRi_BackupBackupBackup_*.tar.gz
```

---

## 🔧 백업 스크립트

### **1. 일반 백업 (1단계)**
```bash
# 스크립트: scripts/duri-backup.sh
# 사용법: ./duri-backup.sh [description]
# 내용: 핵심 파일들만 포함, 불필요한 파일 제외
# 파일명: DuRi_일반백업_날짜_v버전_설명.tar.gz
```

### **2. 중요 백업 (2단계)**
```bash
# 스크립트: scripts/duri-backup-backup.sh
# 사용법: ./duri-backup-backup.sh [description]
# 내용: 중요 파일 + 추가 파일 포함
# 파일명: DuRi_중요백업_날짜_v버전_설명.tar.gz
```

### **3. 완벽한 복제 (3단계)**
```bash
# 스크립트: scripts/duri-backup-backup-backup.sh
# 사용법: ./duri-backup-backup-backup.sh [description]
# 내용: 모든 중요 파일 포함 + 복제 가이드 생성
# 파일명: DuRi_완전복제_날짜_v버전_설명.tar.gz
```

---

## 🚨 백업 명령 시 반드시 지켜야 할 원칙

### **⚠️ 핵심 원칙 1: 백업 요청 중요도에 따른 차별화**
- **"백업"** → 일반 백업 (기본 수준, 핵심 파일만)
- **"백업백업"** → 중요 백업 (중간 수준, 중요 파일 + 추가 파일)
- **"백업백업백업"** → 완벽한 복제 수준 (최고 수준, 모든 파일 + 복제 가이드)

### **⚠️ 핵심 원칙 2: 백업 저장 위치**
- **올바른 위치**: `/mnt/c/Users/admin/Desktop/두리백업/` (바탕화면)
- **잘못된 위치**: `/home/duri/DuRiWorkspace/` (duri_head 내부)
- **백업은 반드시 바탕화면의 "두리백업" 폴더에 저장**

### **⚠️ 핵심 원칙 3: 3단계 백업 시스템의 진짜 목적**
- 단순한 파일 백업이 아님
- **완벽한 시스템 복제**까지 가능한 수준의 백업
- 각 단계별로 포함되는 파일의 범위와 상세도가 다름

### **⚠️ 핵심 원칙 4: 백업 실행 전 확인사항**
1. **백업 위치 확인**: 바탕화면 "두리백업" 폴더인지 확인
2. **백업 수준 확인**: 요청된 백업 수준에 맞는 스크립트 사용
3. **저장 공간 확인**: 바탕화면에 충분한 공간 확보
4. **백업 완료 후**: 바탕화면에 파일이 제대로 저장되었는지 확인

---

## ✅ 백업 명령 시 필수 체크리스트

### **백업 실행 전**
- [ ] **백업 수준 확인**: "백업" vs "백업백업" vs "백업백업백업"
- [ ] **저장 위치 확인**: 바탕화면 "두리백업" 폴더인지 확인
- [ ] **저장 공간 확인**: 바탕화면에 충분한 공간 확보
- [ ] **올바른 스크립트 선택**: 요청된 백업 수준에 맞는 스크립트 사용

### **백업 실행 중**
- [ ] **백업 진행 상황 모니터링**: 진행률 및 오류 메시지 확인
- [ ] **백업 파일명 확인**: 올바른 명명 규칙으로 생성되는지 확인

### **백업 완료 후**
- [ ] **저장 위치 확인**: 바탕화면 "두리백업" 폴더에 파일이 제대로 저장되었는지 확인
- [ ] **파일 크기 확인**: 백업 수준에 맞는 적절한 크기인지 확인
- [ ] **백업 로그 확인**: 백업 과정에서 오류가 없었는지 확인

---

## 🚨 백업 명령 시 절대 잊지 말아야 할 것

1. **"백업"** ≠ **"백업백업"** ≠ **"백업백업백업"** (중요도가 다름!)
2. **백업은 반드시 바탕화면에 저장** (duri_head 내부가 아님!)
3. **3단계 백업은 완벽한 복제 수준까지 가능** (단순 백업이 아님!)
4. **백업 완료 후 반드시 바탕화면에 파일이 저장되었는지 확인**

---

## 🔍 백업 스크립트 실행 방법

### **1. 스크립트 실행 권한 확인**
```bash
cd /home/duri/DuRiWorkspace/scripts
chmod +x duri-backup.sh
chmod +x duri-backup-backup.sh
chmod +x duri-backup-backup-backup.sh
```

### **2. 백업 실행**
```bash
# 일반 백업
./duri-backup.sh "일반 작업 백업"

# 중요 백업
./duri-backup-backup.sh "중요 작업 백업"

# 완벽한 복제
./duri-backup-backup-backup.sh "시스템 복제 백업"
```

### **3. 백업 결과 확인**
```bash
# 바탕화면 "두리백업" 폴더 확인
ls -la /mnt/c/Users/admin/Desktop/두리백업/

# 백업 로그 확인
cat /mnt/c/Users/admin/Desktop/두리백업/backup-log.txt
```

---

## ⚠️ 현재 발견된 문제점 및 해결 방안

### **문제점 1: 백업 파일 저장 위치 오류**
- **현재 상황**: 백업 파일들이 `/home/duri/DuRiWorkspace/`에 저장됨
- **올바른 위치**: `/mnt/c/Users/admin/Desktop/두리백업/`에 저장되어야 함
- **해결 방안**: 백업 스크립트 실행 시 올바른 경로 확인 및 수정

### **문제점 2: 3단계 백업 내용이 동일**
- **현재 상황**: 모든 백업 파일이 47MB로 동일한 내용
- **예상 상황**: 각 단계별로 다른 범위의 파일 포함
- **해결 방안**: 백업 스크립트의 파일 포함 범위 차별화

### **문제점 3: 백업 스크립트 실행 권한 및 경로**
- **확인 필요**: 스크립트 실행 권한, 경로 설정
- **해결 방안**: 스크립트 테스트 및 디버깅

### **즉시 수정해야 할 사항**
1. **백업 위치 수정**: 바탕화면 "두리백업" 폴더로 변경
2. **3단계 백업 중요도 차이 구현**: 각 단계별 파일 포함 범위 차별화
3. **백업 스크립트 테스트**: 올바른 위치에 저장되는지 확인

---

## 📝 백업 파일 검증 명령어

### **1. 백업 파일 내용 확인**
```bash
# 백업 파일 내부 구조 확인
tar -tzf DuRi_일반백업_날짜_v버전_설명.tar.gz | head -20

# 백업 파일 크기 및 날짜 확인
ls -lh /mnt/c/Users/admin/Desktop/두리백업/2025-08/*.tar.gz
```

### **2. 백업 파일 무결성 검사**
```bash
# 백업 파일 무결성 확인
tar -tzf DuRi_일반백업_날짜_v버전_설명.tar.gz > /dev/null && echo "백업 파일 정상" || echo "백업 파일 손상"
```

### **3. 백업 파일 압축 해제 테스트**
```bash
# 임시 디렉토리에서 압축 해제 테스트
mkdir test_extract
cd test_extract
tar -xzf /mnt/c/Users/admin/Desktop/두리백업/2025-08/DuRi_일반백업_날짜_v버전_설명.tar.gz
ls -la
cd ..
rm -rf test_extract
```

---

## 🔗 관련 문서

- `BACKUP_ROLLBACK_GUIDE.md` - 백업 및 롤백 완전 가이드
- `BACKUP_INFO.md` - 백업 시스템 개요
- `AUGUST_6_7_WORK_SUMMARY.md` - 8월 6-7일 작업 요약

---

## 📅 백업 파일 생성 일정

### **8월 7일 백업**
- Phase4, Phase5, Phase6 백업 (600MB+)
- 3단계 통합 학습 시스템 백업
- 전략 판단 4단계 통합 시스템 백업

### **8월 8일 백업**
- learning_system_fully_activated 백업
- 통합 시스템 및 추론 시스템 백업

### **8월 10일 백업**
- 백업, 백업백업, 백업백업백업 (47MB)
- DuRiCore 모듈별 백업

---

> **📌 이 문서는 백업 명령 시 반드시 참조해야 하는 핵심 문서입니다!**
> **백업 작업 전에 반드시 이 가이드를 확인하고 따라주세요!**
> **백업 명령 시에는 반드시 위의 원칙들을 지켜주세요!**
