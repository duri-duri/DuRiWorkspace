# E_ext_template.xlsx 분석 및 최적화

## 📋 현재 템플릿 분석

### ✅ 강점
1. **명확한 방정식 정의**: `E_ext = (ΔF/Δt / C_met) * S * (1 - R) * A`
2. **체계적 입력 지침**: 각 변수별 상세 설명
3. **실용적 점수 해석**: 0~60/60~80/80~95/95+ 구간별 가이드
4. **워크플로 제시**: 데이터 입력 → 분석 → 처방 수정 프로세스

### 🔧 개선 포인트
1. **측정 방법 표준화**: 각 점수별 구체적 측정 기준 부족
2. **자동화 부족**: 수동 계산 → Excel 수식 자동화 필요
3. **시각화 부족**: 추세 분석을 위한 차트/그래프 없음
4. **검증 로직 부족**: 입력값 범위 검증 및 오류 방지

## 🚀 최적화된 템플릿 설계

### 1. 데이터 입력 시트 (Data)
| 컬럼 | 설명 | 데이터 타입 | 검증 규칙 |
|------|------|-------------|-----------|
| Date | 측정 날짜 | Date | YYYY-MM-DD |
| Patient | 환자명 | Text | 필수 |
| Exercise | 운동 종류 | Text | 드롭다운 (케틀벨, 맨몸, 박스스쿼트 등) |
| F_score | 힘 증가율 (0~5) | Number | 0~5 범위 |
| C_met | 대사 비용 (≥1) | Number | ≥1 범위 |
| S_score | 시너지 (0~5) | Number | 0~5 범위 |
| R_risk | 손상 위험 (0~1) | Number | 0~1 범위 |
| A_adapt | 적응력 (0~1.2) | Number | 0~1.2 범위 |
| E_ext | 효율 점수 | Formula | 자동 계산 |
| Notes | 특이사항 | Text | 선택사항 |

### 2. 자동 계산 수식
```excel
E_ext = (F_score / C_met) * S_score * (1 - R_risk) * A_adapt * 20
```
*20을 곱해서 0~100 점수로 변환

### 3. 분석 시트 (Analysis)
- 환자별 E_ext 추세 그래프
- 운동별 평균 효율 비교
- 위험도(R_risk) 모니터링 차트
- 월간/주간 성과 대시보드

### 4. 가이드 시트 (Guide)
- 점수 해석 가이드
- 측정 방법 상세 설명
- 워크플로 단계별 가이드
- 문제 해결 가이드

## 📊 구현 우선순위

### Phase 1: 기본 기능
1. 데이터 입력 시트 + 자동 계산
2. 기본 검증 규칙
3. 간단한 분석 차트

### Phase 2: 고급 기능
1. 환자별 추세 분석
2. 운동별 비교 분석
3. 알림 시스템 (위험도 상승 시)

### Phase 3: 통합 기능
1. 두리 시스템과 연동
2. 자동 데이터 수집
3. AI 기반 처방 제안

## 🎯 다음 단계 제안

1. **Excel 템플릿 생성**: 위 설계를 기반으로 실제 Excel 파일 생성
2. **테스트 데이터 입력**: 샘플 데이터로 기능 검증
3. **병원 적용 테스트**: 실제 환자 데이터로 검증
4. **두리 시스템 연동**: 자동화 및 AI 기능 추가
