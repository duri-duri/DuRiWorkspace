groups:
- name: quality-slo
  interval: 1m
  rules:
  - record: duri_ndcg_ma7
    expr: avg_over_time(duri_ndcg_at_k{k="3",scope="all",domain="ALL"}[7d])
  - record: duri_mrr_ma7
    expr: avg_over_time(duri_mrr_at_k{k="3",scope="all",domain="ALL"}[7d])
  - record: duri_recall3_ma7
    expr: avg_over_time(duri_recall_at_k{k="3",scope="all",domain="ALL"}[7d])

  - record: duri_ndcg_errbudget
    expr: (slo_ndcg_target - duri_ndcg_ma7)
  - record: duri_mrr_errbudget
    expr: (slo_mrr_target - duri_mrr_ma7)
  - record: duri_recall3_errbudget
    expr: (slo_recall3_target - duri_recall3_ma7)

  # MRR SLO gap (새 레코드로 분리)
  - record: duri_mrr_slo_gap_ma7
    expr: (slo_mrr_target - duri_mrr_ma7)
