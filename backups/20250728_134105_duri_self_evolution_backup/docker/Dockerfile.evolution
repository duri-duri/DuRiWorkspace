FROM duri-base:latest

WORKDIR /app

# Evolution 서비스 파일 복사
COPY duri_evolution/ /app/duri_evolution/

# duri_core 소스도 함께 복사
COPY duri_core/ /app/duri_core/

# Evolution 서비스 의존성 설치
COPY duri_evolution/requirements.txt ./requirements.txt
RUN pip install --no-cache-dir -r requirements.txt

# PYTHONPATH를 /app:/app/duri_core로 설정
ENV PYTHONPATH="/app:/app/duri_core"

# Evolution 서비스 실행
CMD ["python", "duri_evolution/run.py"]
