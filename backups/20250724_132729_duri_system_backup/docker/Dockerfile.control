FROM duri-base:latest

WORKDIR /app

# Control 서비스 파일 복사
COPY duri_control/ /app/duri_control/

# Control 서비스 의존성 설치
COPY duri_control/requirements.txt ./requirements.txt
RUN pip install --no-cache-dir -r requirements.txt

# Docker CLI 설치 (컨테이너 모니터링용)
RUN apt-get update && apt-get install -y docker.io && rm -rf /var/lib/apt/lists/*

# Control 서비스 실행 (uvicorn 직접 사용)
CMD ["uvicorn", "duri_control.run:app", "--host", "0.0.0.0", "--port", "8083"] 