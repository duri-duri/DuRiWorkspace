echo ""

# 1. Shadow í›ˆë ¨ ì„œë¹„ìŠ¤ ì‹œì‘ (profiles: ["train"])
echo "ğŸš€ Shadow í›ˆë ¨ ì„œë¹„ìŠ¤ ì‹œì‘ ì¤‘..."
$DC --profile train up -d

# 2. Shadow í™œì„±í™”
echo "ğŸ”„ Shadow í™œì„±í™” ì¤‘..."
$REDIS_CLI SET shadow:enabled 1 || true

# 3. ì¹´ë‚˜ë¦¬ ë¹„ìœ¨ ì„¤ì • (10%ë¶€í„° ì‹œì‘)
echo "ğŸ“Š ì¹´ë‚˜ë¦¬ ë¹„ìœ¨ 10% ì„¤ì • ì¤‘..."
$REDIS_CLI SET canary:ratio 0.1 || true

# 4. ìƒíƒœ í™•ì¸
echo "ğŸ“‹ ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸..."
docker compose ps | grep -E "(duri_core|duri_brain|duri_evolution|duri_control|duri-postgres|duri-redis)"

echo ""
echo "âœ… Shadow í›ˆë ¨ì¥ ì‹œì‘ ì™„ë£Œ"
echo "ğŸ¯ ë‹¤ìŒ ë‹¨ê³„:"
echo "   - 10ë¶„ í›„: ./check_srm_and_guard.sh"
echo "   - 30ë¶„ í›„: ./run_promote_canary.sh 0.50"
echo "   - ì €ë… í‡´ê·¼ ì‹œ: ./ops/shadow_off.sh"

echo "â° ì‹¤í–‰ ì‹œê°„: $(date)"
