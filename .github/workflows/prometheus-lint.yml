name: prometheus-lint

on: [push, pull_request]

jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: promtool check config & rules (minimal)
        run: |
          docker run --rm --entrypoint /bin/sh \
            -v "$PWD/prometheus:/etc/prometheus:ro" prom/prometheus:v2.54.1 -lc '
              promtool check config /etc/prometheus/prometheus.yml.minimal &&
              promtool check rules /etc/prometheus/rules/*.yml
            '

